<html>
<head><title>Tree Calculation</title></head>
<body>
<p><strong>Calculation of trees from alignments</strong></p>
<p>Trees are calculated on either the complete alignment, or just the
currently selected group of sequences, using the functions in the
<strong>Calculate&#8594;Calculate tree</strong> submenu. 
Once calculated, trees are displayed in a new <a 
href="../calculations/treeviewer.html">tree viewing window</a>. There are
four different calculations, using one of two distance measures and
constructing the tree from one of two algorithms :
</p>
<p><strong>Distance Measures</strong></p>
<p>Trees are calculated on the basis of a measure of similarity
between each pair of sequences in the alignment :
<ul>
<li><strong>PID</strong><br>The percentage identity between the two
sequences at each aligned position.<ul><li>PID = Number of equivalent
aligned non-gap symbols * 100 / Smallest number of non-gap positions
in either of both sequences<br><em>This is essentially the 'number of
identical bases (or residues) per 100 base pairs (or residues)'.</em></li></ul>
<li><strong>BLOSUM62</strong><br>The sum of BLOSUM62 scores for the
residue pair at each aligned position.
</ul>
</p>
<p><strong>Tree Construction Methods</strong></p>
<p>Jalview currently supports two kinds of agglomerative clustering
methods. These are not intended to substitute for rigorous
phylogenetic tree construction, and may fail on very large alignments.
<ul>
<li><strong>UPGMA tree</strong><br>
  UPGMA stands for Unweighted Pair-Group Method using Arithmetic
  averages. Clusters are iteratively formed and extended by finding a
  non-member sequence with the lowest average dissimilarity over the
  cluster members.
<p></p>
</li>
<li><strong>Neighbour Joining tree</strong><br>
  First described in 1987 by Saitou and Nei, this method applies a
  greedy algorithm to find the tree with the shortest branch
  lengths.<br>
  This method, as implemented in Jalview, is considerably more
  expensive than UPGMA.
</li>
</ul>
</p>
<p>A newly calculated tree will be displayed in a new <a
href="../calculations/treeviewer.html">tree viewing window</a>. In
addition, a new entry with the same tree viewer window name will be added in the Sort
menu so that the alignment can be reordered to reflect the ordering of
the leafs of the tree. If the tree was calculated on a selected region
of the alignment, then the title of the tree view will reflect this.</p>

<p><strong>External Sources for Phylogenetic Trees</strong></p>
  <p>A number of programs exist for the reliable construction of
  phylogenetic trees, which can cope with large numbers of sequences,
  use better distance methods and can perform bootstrapping. Jalview
  can read <a
  href="http://evolution.genetics.washington.edu/phylip/newick_doc.html">Newick</a>
  format tree files using the 'Load Associated Tree' entry of the
  alignment's File menu. Sequences in the alignment will be
  automatically associated to nodes in the tree, by matching Sequence
  IDs to the tree's leaf names.
  </p>


</body>
</html>
